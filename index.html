<!DOCTYPE html>
 <html lang="pt-BR">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Clínica Mentalize | Sistema de Agendamentos</title>
     <style>
         /* Seus estilos CSS permanecem os mesmos */
         /* ... */
     </style>
 </head>
 <body>
 
     <!-- Seu HTML permanece o mesmo até o formulário de agendamento -->
     <!-- ... -->
 
     <div class="container">
         <!-- Área Pública -->
         <div id="areaPublica">
             <!-- Seção de Agendamento -->
             <section id="agendamento" class="card">
                 <h2>Agendar Consulta</h2>
                 <form id="formAgendamento">
                     <input type="text" id="nomePaciente" placeholder="Nome do Paciente" required>
                     <input type="date" id="dataConsulta" required>
                     <input type="time" id="horaConsulta" required>
                     <select id="profissional" required>
                         <option value="">Selecione o Profissional</option>
                         <option value="psicologo1">Dra. Cicera Santana</option>
                     </select>
                     <textarea id="observacoes" placeholder="Observações" rows="3"></textarea>
                     <button type="submit">Agendar Consulta</button>
                 </form>
                 <div id="agendamentoSucesso" style="display: none; margin-top: 15px; padding: 10px; background-color: #d4edda; color: #155724; border-radius: 5px;">
                     Agendamento realizado com sucesso!
                 </div>
                 <div id="agendamentoErro" style="display: none; margin-top: 15px; padding: 10px; background-color: #f8d7da; color: #721c24; border-radius: 5px;">
                 </div>
             </section>
 
             <!-- Restante do seu HTML permanece o mesmo -->
             <!-- ... -->
         </div>
 
         <!-- Área do Profissional -->
         <div id="areaProfissional">
             <section class="card">
                 <h2>Bem-vindo, <span id="profissionalNome"></span></h2>
                 <p>Últimos agendamentos:</p>
                 <table id="tabelaAgendamentos">
                     <thead>
                         <tr>
                             <th>Paciente</th>
                             <th>Data</th>
                             <th>Hora</th>
                             <th>Profissional</th>
                             <th>Observações</th>
                             <th>Ações</th>
                         </tr>
                     </thead>
                     <tbody>
                         <!-- Os agendamentos serão inseridos aqui dinamicamente -->
                     </tbody>
                 </table>
             </section>
 
             <!-- Restante do HTML da área profissional -->
             <!-- ... -->
         </div>
     </div>
 
     <!-- Modal de Login -->
     <!-- ... -->
 
     <footer>
         <p>© Clínica Mentalize | Atendimento Psicológico - Todos os direitos reservados</p>
     </footer>
 
     <script>
         // Armazenamento de agendamentos
         let agendamentos = JSON.parse(localStorage.getItem('agendamentos')) || [];
         
         // Controle do Login (seu código existente)
         document.addEventListener('DOMContentLoaded', function() {
             const modal = document.getElementById('loginModal');
             const loginLink = document.getElementById('loginLink');
             const logoutBtn = document.getElementById('logoutBtn');
             const closeBtn = document.querySelector('.close');
             const loginForm = document.getElementById('loginForm');
             const errorMessage = document.getElementById('errorMessage');
             const areaPublica = document.getElementById('areaPublica');
             const areaProfissional = document.getElementById('areaProfissional');
             const userGreeting = document.getElementById('userGreeting');
             const profissionalNome = document.getElementById('profissionalNome');
             const formAgendamento = document.getElementById('formAgendamento');
             const agendamentoSucesso = document.getElementById('agendamentoSucesso');
             const agendamentoErro = document.getElementById('agendamentoErro');
 
             // Credenciais válidas (simuladas)
             const validUsers = {
                 'cicera.santana': { password: 'senha123', nome: 'Dra. Cicera Santana' },
             };
 
             // Verificar se já está logado (simulação)
             checkLogin();
 
             // Abrir modal
             loginLink.addEventListener('click', function(e) {
                 e.preventDefault();
                 modal.style.display = 'block';
             });
 
             // Fechar modal
             closeBtn.addEventListener('click', closeModal);
             window.addEventListener('click', function(e) {
                 if (e.target === modal) closeModal();
             });
 
             // Logout
             logoutBtn.addEventListener('click', function() {
                 localStorage.removeItem('loggedInUser');
                 checkLogin();
             });
 
             // Validação de login
             loginForm.addEventListener('submit', function(e) {
                 e.preventDefault();
                 const username = document.getElementById('username').value.trim();
                 const password = document.getElementById('password').value;
 
                 if (validUsers[username] && validUsers[username].password === password) {
                     // Login bem-sucedido
                     localStorage.setItem('loggedInUser', JSON.stringify({
                         username: username,
                         nome: validUsers[username].nome
                     }));
                     closeModal();
                     checkLogin();
                     atualizarTabelaAgendamentos();
                 } else {
                     errorMessage.textContent = 'Usuário ou senha incorretos!';
                 }
             });
 
             // Formulário de agendamento
             formAgendamento.addEventListener('submit', function(e) {
                 e.preventDefault();
                 
                 const nomePaciente = document.getElementById('nomePaciente').value;
                 const dataConsulta = document.getElementById('dataConsulta').value;
                 const horaConsulta = document.getElementById('horaConsulta').value;
                 const profissional = document.getElementById('profissional').value;
                 const observacoes = document.getElementById('observacoes').value;
                 
                 // Validar data (não pode ser no passado)
                 const hoje = new Date();
                 const dataAgendamento = new Date(dataConsulta + 'T' + horaConsulta);
                 
                 if (dataAgendamento < hoje) {
                     agendamentoErro.textContent = 'Não é possível agendar para datas/horários passados.';
                     agendamentoErro.style.display = 'block';
                     agendamentoSucesso.style.display = 'none';
                     return;
                 }
                 
                 // Criar novo agendamento
                 const novoAgendamento = {
                     id: Date.now(), // ID único baseado no timestamp
                     paciente: nomePaciente,
                     data: dataConsulta,
                     hora: horaConsulta,
                     profissional: profissional,
                     observacoes: observacoes,
                     status: 'agendado'
                 };
                 
                 // Adicionar ao array de agendamentos
                 agendamentos.push(novoAgendamento);
                 
                 // Salvar no localStorage
                 localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
                 
                 // Feedback para o usuário
                 agendamentoSucesso.style.display = 'block';
                 agendamentoErro.style.display = 'none';
                 
                 // Limpar formulário
                 formAgendamento.reset();
                 
                 // Atualizar tabela se estiver na área profissional
                 if (areaProfissional.style.display === 'block') {
                     atualizarTabelaAgendamentos();
                 }
                 
                 // Esconder mensagem de sucesso após 3 segundos
                 setTimeout(() => {
                     agendamentoSucesso.style.display = 'none';
                 }, 3000);
             });
 
             function closeModal() {
                 modal.style.display = 'none';
                 errorMessage.textContent = '';
                 loginForm.reset();
             }
 
             function checkLogin() {
                 const user = JSON.parse(localStorage.getItem('loggedInUser'));
                 if (user) {
                     // Usuário logado
                     loginLink.style.display = 'none';
                     logoutBtn.style.display = 'inline-block';
                     userGreeting.textContent = `Olá, ${user.nome.split(' ')[1]}!`;
                     profissionalNome.textContent = user.nome;
                     areaPublica.style.display = 'none';
                     areaProfissional.style.display = 'block';
                     atualizarTabelaAgendamentos();
                 } else {
                     // Usuário não logado
                     loginLink.style.display = 'inline-block';
                     logoutBtn.style.display = 'none';
                     userGreeting.textContent = '';
                     areaPublica.style.display = 'block';
                     areaProfissional.style.display = 'none';
                 }
             }
             
             function atualizarTabelaAgendamentos() {
                 const tabela = document.querySelector('#tabelaAgendamentos tbody');
                 tabela.innerHTML = '';
                 
                 // Ordenar agendamentos por data e hora (mais recentes primeiro)
                 const agendamentosOrdenados = [...agendamentos].sort((a, b) => {
                     const dataA = new Date(a.data + 'T' + a.hora);
                     const dataB = new Date(b.data + 'T' + b.hora);
                     return dataA - dataB;
                 });
                 
                 agendamentosOrdenados.forEach(agendamento => {
                     const tr = document.createElement('tr');
                     
                     // Formatando a data para exibição (DD/MM/AAAA)
                     const dataParts = agendamento.data.split('-');
                     const dataFormatada = `${dataParts[2]}/${dataParts[1]}/${dataParts[0]}`;
                     
                     tr.innerHTML = `
                         <td>${agendamento.paciente}</td>
                         <td>${dataFormatada}</td>
                         <td>${agendamento.hora}</td>
                         <td>${agendamento.profissional === 'psicologo1' ? 'Dra. Cicera Santana' : agendamento.profissional}</td>
                         <td>${agendamento.observacoes || '-'}</td>
                         <td>
                             <button class="cancelar-btn" data-id="${agendamento.id}">Cancelar</button>
                         </td>
                     `;
                     
                     tabela.appendChild(tr);
                 });
                 
                 // Adicionar eventos aos botões de cancelar
                 document.querySelectorAll('.cancelar-btn').forEach(btn => {
                     btn.addEventListener('click', function() {
                         const id = parseInt(this.getAttribute('data-id'));
                         cancelarAgendamento(id);
                     });
                 });
             }
             
             function cancelarAgendamento(id) {
                 if (confirm('Tem certeza que deseja cancelar este agendamento?')) {
                     agendamentos = agendamentos.filter(ag => ag.id !== id);
                     localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
                     atualizarTabelaAgendamentos();
                 }
             }
         });
     </script>
 </body>
 </html>
